def COUNTER 5000008
store 2 0 0 0 $COUNTER
::REPEAT
store 2 0 0 ``STRING_DATA $BIOS_ARG1
store 2 0 0 2 $BIOS_ARG2
jump 1 0 0 ``SUB_START
add 3 1 0 $COUNTER 1 $COUNTER
compare 2 1 0 $COUNTER 5
branch 2 0 0 3 ``HALT
goto 1 0 0 ``REPEAT
::HALT
halt 0 0 0
::SUB_START
def POINTER 999000
def TARGET 999001
def TMP_DAT 999002
def 8BIT_A 999003
def 8BIT_B 999004
def 8BIT_C 999005
def 8BIT_D 999006
def CHAR_POINTER 999007
def CHAR_COUNTER 999008
def CHAR_DATA 999009
copy 2 0 0 $BIOS_ARG1 $POINTER 
add 3 0 0 $BIOS_ARG1 $BIOS_ARG2 $TARGET
::LOOP
copy 2 1 0 $POINTER $TMP_DAT
unpack8 2 0 0 $TMP_DAT $8BIT_A
store 2 0 0 $8BIT_A $CHAR_POINTER
store 2 0 0 0 $CHAR_COUNTER
::CHAR_LOOP
copy 2 1 0 $CHAR_POINTER $TMP_DAT
compare 2 1 0 $TMP_DAT 0
branch 2 0 0 3 ``CHAR_LOOP_EXIT
mult 3 1 0 $TMP_DAT 16777216 $TMP_DAT
add 3 1 0 $TMP_DAT 1 $TMP_DAT
copy 2 0 0 $TMP_DAT $SERIAL_OUT
add 3 1 0 $CHAR_POINTER 1 $CHAR_POINTER
add 3 1 0 $CHAR_COUNTER 1 $CHAR_COUNTER
compare 2 1 0 $CHAR_COUNTER 4
branch 2 0 0 3 ``CHAR_LOOP_EXIT
goto 1 0 0 ``CHAR_LOOP
::CHAR_LOOP_EXIT
add 3 1 0 $POINTER 1 $POINTER
compare 2 1 1 $POINTER $TARGET
branch 2 0 0 3 ``SUB_RETURN
goto 1 0 0 ``LOOP
::SUB_RETURN
return 0 0 0
::STRING_DATA
=0x4b435553
=0x0a544920